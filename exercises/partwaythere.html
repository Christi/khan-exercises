<!DOCTYPE html>
<html data-require="math graphie jquery.mobile.vmouse">
    <head>
		<title>Venn Diagrams 0.5</title>
		<script src="../khan-exercise.js"></script>
	</head>
	<body>
		<div class="exercise">
			<div class="vars">
				<var id="radius1"> 8 </var>
				<var id="radius2"> 8 </var>
				<var id="center1"> [ -10 , 0 ] </var>
				<var id="center2"> [ 0 , 0 ] </var>
				<var id="inter1"> [ -5 , sqrt(39) ]</var>
				<var id="inter2"> [ -5 , -sqrt(39) ]</var>
				<var id="shaded"> randRange(1,7) </var>
				<var id="Regions"> ["B \\cap \\lnot A", "A \\cap B", "B", "A \\cap \\lnot B", "\\lnot A \\cup \\lnot B", "A", "A \\cup B"]</var>
				<var id="ShadedText">Regions[shaded-1]</var>
				<var id="shadedBinary">shaded.toString(2)</var>
			</div>

			<div class="problems">
				<div id="shade-the-diagram">
						
						<div class="problem">
							<p class="question">
								Shade the Venn Diagram to match <code><var>ShadedText</var></code>.
							</p>
							<div class="graphie" id="Venn_Diagram">
								init({
									range: [ [ -20, 15 ], [ -10, 10 ] ],
									scale: [ 15, 15 ] 
								});
								
								style({
									stroke: "Black",
									strokeWidth: 5, // px; "2px" works too
								});

								// Left Circle
								circle( center1, radius1, {
									stroke: "Black",
									strokeWidth: 5,
								});
								label( [-12,9],"\\huge{A}", "left");
								// Right Circle
								circle( center2, radius2, {
									stroke: "Black",
									strokeWidth: 5,
								});
								label( [2, 9],"\\huge{B}", "right" );
								
								var scale_and_join= function(x)
									{
										var temp=scalePoint(x);
										return temp.join(" ")
									}	;
									
								var arc_string =
									function(start,end,radius,largeAngle,sweep){
										var radii=scaleVector(radius);
						
										var retstring="M" + scale_and_join(start) + "A" + radii.join(" ") + " 0 " + ( largeAngle ? 1 : 0 ) + " " +(sweep?1:0) + " " + scale_and_join(end)  ;
										
										return retstring;
										};
								
								var	curve_inner_circle1=arc_string(inter1,inter2,radius1,0,1);
								var curve_inner_circle2=arc_string(inter1,inter2,radius2,0,0);
								var curve_outer_circle1=arc_string(inter1,inter2,radius1,1,1);
								var curve_outer_circle2=arc_string(inter1,inter2,radius2,1,0);
								
								
								intersection= currentGraph.raphael.path(curve_inner_circle1 +curve_inner_circle2 + "M" + scale_and_join(inter1) +" Z" ).attr({ fill: ORANGE, "stroke-width":4, "fill-opacity":0	});
								
								var radii1=scaleVector(radius1);
								
								justB =currentGraph.raphael.path(curve_inner_circle1 + "A " + radii1.join(" ") + " 0 1 0 " + scale_and_join(inter1) +"M" + scale_and_join(inter1) +" Z").attr({fill:BLUE, "stroke-width":4, "fill-opacity":0 });
								
								justA =currentGraph.raphael.path(curve_inner_circle2 + "A " + radii1.join(" ") + " 0 1 1 " + scale_and_join(inter1) +"M" + scale_and_join(inter1) +" Z").attr({fill:GREEN, "stroke-width":4, "fill-opacity":0 });
								
								jQuery(intersection.node).bind("vmousedown",function() {
									intersection.attr({'fill-opacity': intersection.attr('fill-opacity') === 1 ? 0 : 1})
								})
								jQuery(justA.node).bind("vmousedown",function() {
									justA.attr({'fill-opacity': justA.attr('fill-opacity') === 1 ? 0 : 1})
								})
								jQuery(justB.node).bind("vmousedown",function() {
									justB.attr({'fill-opacity': justB.attr('fill-opacity') === 1 ? 0 : 1})
								})

							</div>
						<!-- An overview of the problem including all needed info. -->
						</div>

							
						<div class="solution" data-type="custom">
							<div class="instruction">
								Click on the areas in the Venn Diagram to shade the matching regions.
							</div>
							<div class="guess"> (digitsToInteger([parseInt(jQuery(justA.node).attr('fill-opacity')),parseInt(jQuery(intersection.node).attr('fill-opacity')),parseInt(jQuery(justB.node).attr('fill-opacity'))]))
							</div>
							<div class="validator-function">
								if ( guess === 0 ) {
									return "";
								} else {
									return guess === parseInt(shadedBinary);
								}
							</div>
							<div class="show-guess">
								var area=digits(guess);
																
								//unselect all
								jQuery(justA.node).attr('fill-opacity':0);
								jQuery(justB.node).attr('fill-opacity':0);
								jQuery(intersection).node.attr('fill-opacity':0);
								
								//select shaded regions
								jQuery(justA.node).attr('fill-opacity':area[0]);
								jQuery(intersection.node).attr('fill-opacity':area[1]);
								jQuery(justB.node).attr('fill-opacity':area[2]);
							</div>
							<div class="example">click a region to select it</div>
							<div class="example">click a region again to deselect it</div>
						</div>
						
						<div class="hints">
							<!-- Any hints to show to the student. -->
						</div>
				</div>
            </div>

			
		</div>
	</body>
</html>
